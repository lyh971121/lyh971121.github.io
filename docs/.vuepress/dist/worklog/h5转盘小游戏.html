<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>h5转盘小游戏 | 小刘的工作日志</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/assets/css/0.styles.9854472c.css" as="style"><link rel="preload" href="/assets/js/app.76969911.js" as="script"><link rel="preload" href="/assets/js/2.948fdc9a.js" as="script"><link rel="prefetch" href="/assets/js/10.4f7cce93.js"><link rel="prefetch" href="/assets/js/11.0adbb2f5.js"><link rel="prefetch" href="/assets/js/12.6e51be01.js"><link rel="prefetch" href="/assets/js/13.536b90fc.js"><link rel="prefetch" href="/assets/js/14.17ad1125.js"><link rel="prefetch" href="/assets/js/15.f401c76b.js"><link rel="prefetch" href="/assets/js/16.19c47086.js"><link rel="prefetch" href="/assets/js/17.65764b60.js"><link rel="prefetch" href="/assets/js/18.97c30e6b.js"><link rel="prefetch" href="/assets/js/19.52ae4d91.js"><link rel="prefetch" href="/assets/js/20.6f418fed.js"><link rel="prefetch" href="/assets/js/21.58f690e8.js"><link rel="prefetch" href="/assets/js/22.78e3f2df.js"><link rel="prefetch" href="/assets/js/23.6886bf93.js"><link rel="prefetch" href="/assets/js/24.72d8db38.js"><link rel="prefetch" href="/assets/js/25.325becc6.js"><link rel="prefetch" href="/assets/js/26.96453980.js"><link rel="prefetch" href="/assets/js/27.93e0836c.js"><link rel="prefetch" href="/assets/js/28.9abc5e9e.js"><link rel="prefetch" href="/assets/js/29.9afb4f4a.js"><link rel="prefetch" href="/assets/js/3.c9aad935.js"><link rel="prefetch" href="/assets/js/30.93843891.js"><link rel="prefetch" href="/assets/js/31.ccfd8d15.js"><link rel="prefetch" href="/assets/js/32.3a09804d.js"><link rel="prefetch" href="/assets/js/33.dce449ba.js"><link rel="prefetch" href="/assets/js/34.0417e7c2.js"><link rel="prefetch" href="/assets/js/35.944c46e5.js"><link rel="prefetch" href="/assets/js/36.80caeab4.js"><link rel="prefetch" href="/assets/js/37.a6d4a4ed.js"><link rel="prefetch" href="/assets/js/38.194267c7.js"><link rel="prefetch" href="/assets/js/39.a8f8c89c.js"><link rel="prefetch" href="/assets/js/4.5d6613c8.js"><link rel="prefetch" href="/assets/js/40.3360e97c.js"><link rel="prefetch" href="/assets/js/41.227ee9e8.js"><link rel="prefetch" href="/assets/js/42.080cbd8f.js"><link rel="prefetch" href="/assets/js/43.b1806efa.js"><link rel="prefetch" href="/assets/js/44.0c26bd58.js"><link rel="prefetch" href="/assets/js/45.b909648f.js"><link rel="prefetch" href="/assets/js/46.9ebd14a7.js"><link rel="prefetch" href="/assets/js/47.48358785.js"><link rel="prefetch" href="/assets/js/48.8dc5a688.js"><link rel="prefetch" href="/assets/js/49.91e368c0.js"><link rel="prefetch" href="/assets/js/5.6df6b652.js"><link rel="prefetch" href="/assets/js/50.008ce52d.js"><link rel="prefetch" href="/assets/js/51.90e9c1cd.js"><link rel="prefetch" href="/assets/js/52.7a975763.js"><link rel="prefetch" href="/assets/js/53.eeb16780.js"><link rel="prefetch" href="/assets/js/54.4de613f8.js"><link rel="prefetch" href="/assets/js/55.44ac75cb.js"><link rel="prefetch" href="/assets/js/56.9c652d62.js"><link rel="prefetch" href="/assets/js/57.dd35a368.js"><link rel="prefetch" href="/assets/js/58.094ac1c1.js"><link rel="prefetch" href="/assets/js/59.c118e37a.js"><link rel="prefetch" href="/assets/js/6.f89ffadd.js"><link rel="prefetch" href="/assets/js/60.c44f4bb2.js"><link rel="prefetch" href="/assets/js/61.c4301b0e.js"><link rel="prefetch" href="/assets/js/62.6963b5c6.js"><link rel="prefetch" href="/assets/js/63.d548afb9.js"><link rel="prefetch" href="/assets/js/64.93c5ec12.js"><link rel="prefetch" href="/assets/js/65.6b9907d4.js"><link rel="prefetch" href="/assets/js/7.42473645.js"><link rel="prefetch" href="/assets/js/8.7fa5b70b.js"><link rel="prefetch" href="/assets/js/9.bbd4c375.js">
    <link rel="stylesheet" href="/assets/css/0.styles.9854472c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">小刘的工作日志</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/worklog/" class="nav-link router-link-active">worklog</a></div><div class="nav-item"><a href="/front/" class="nav-link">front</a></div><div class="nav-item"><a href="/houduan/" class="nav-link">back</a></div><div class="nav-item"><a href="/devOps/" class="nav-link">devOps</a></div><div class="nav-item"><a href="/interview/" class="nav-link">interview</a></div><div class="nav-item"><a href="/article/" class="nav-link">article</a></div><div class="nav-item"><a href="https://github.com/lyh971121" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/worklog/" class="nav-link router-link-active">worklog</a></div><div class="nav-item"><a href="/front/" class="nav-link">front</a></div><div class="nav-item"><a href="/houduan/" class="nav-link">back</a></div><div class="nav-item"><a href="/devOps/" class="nav-link">devOps</a></div><div class="nav-item"><a href="/interview/" class="nav-link">interview</a></div><div class="nav-item"><a href="/article/" class="nav-link">article</a></div><div class="nav-item"><a href="https://github.com/lyh971121" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>worklog</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/worklog/技术分享.html" class="sidebar-link">技术分享</a></li><li><a href="/worklog/h5转盘小游戏.html" class="active sidebar-link">h5转盘小游戏</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/worklog/h5转盘小游戏.html#欢乐转盘和黄金转盘效果：" class="sidebar-link">欢乐转盘和黄金转盘效果：</a></li><li class="sidebar-sub-header"><a href="/worklog/h5转盘小游戏.html#视口及背景的切换" class="sidebar-link">视口及背景的切换</a></li><li class="sidebar-sub-header"><a href="/worklog/h5转盘小游戏.html#样式部分" class="sidebar-link">样式部分</a></li><li class="sidebar-sub-header"><a href="/worklog/h5转盘小游戏.html#难点1：转盘中间礼物的展示" class="sidebar-link">难点1：转盘中间礼物的展示</a></li><li class="sidebar-sub-header"><a href="/worklog/h5转盘小游戏.html#难点2：转盘旋转特效" class="sidebar-link">难点2：转盘旋转特效</a></li><li class="sidebar-sub-header"><a href="/worklog/h5转盘小游戏.html#难点3：转盘指针动画效果" class="sidebar-link">难点3：转盘指针动画效果</a></li><li class="sidebar-sub-header"><a href="/worklog/h5转盘小游戏.html#难点4：交互部分" class="sidebar-link">难点4：交互部分</a></li></ul></li><li><a href="/worklog/红包活动.html" class="sidebar-link">红包活动</a></li><li><a href="/worklog/mock.html" class="sidebar-link">Mockjs</a></li><li><a href="/worklog/koa.html" class="sidebar-link">koa原理</a></li><li><a href="/worklog/http.html" class="sidebar-link">http</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="h5转盘小游戏"><a href="#h5转盘小游戏" aria-hidden="true" class="header-anchor">#</a> h5转盘小游戏</h1> <p></p><div class="table-of-contents"><ul><li><a href="#欢乐转盘和黄金转盘效果：">欢乐转盘和黄金转盘效果：</a></li><li><a href="#视口及背景的切换">视口及背景的切换</a></li><li><a href="#样式部分">样式部分</a></li><li><a href="#难点1：转盘中间礼物的展示">难点1：转盘中间礼物的展示</a></li><li><a href="#难点2：转盘旋转特效">难点2：转盘旋转特效</a></li><li><a href="#难点3：转盘指针动画效果">难点3：转盘指针动画效果</a></li><li><a href="#难点4：交互部分">难点4：交互部分</a></li></ul></div><p></p> <h2 id="欢乐转盘和黄金转盘效果："><a href="#欢乐转盘和黄金转盘效果：" aria-hidden="true" class="header-anchor">#</a> 欢乐转盘和黄金转盘效果：</h2> <img src="/assets/img/11.d449bd39.gif" style="zoom: 20%"> <img src="/assets/img/22.0a4afadc.gif" style="zoom: 30%"> <p><strong>1、转盘分为欢乐转盘和黄金转盘，区别在于黄金转盘所需金币更多，奖品更大</strong></p> <p><strong>2、点击视口上方tab可进行游戏切换</strong></p> <p><strong>3、点击开始前，可选择转一次，十次或五十次</strong></p> <p><strong>4、点击开始后，把用户信息及转动次数传给接口，返回中奖礼物进行展示</strong></p> <h2 id="视口及背景的切换"><a href="#视口及背景的切换" aria-hidden="true" class="header-anchor">#</a> 视口及背景的切换</h2> <p><strong>1、根据蓝狐设计稿，确定窗口尺寸</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//游戏视口主要使用定位，窗口以外topWarp区域点击可关闭游戏</span>
<span class="token comment">//根据tabIndex值，实现tab是否高亮及背景图的展示</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;container&quot;</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;topWarp&quot;</span> @click<span class="token operator">=</span><span class="token string">&quot;closeGame&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token comment">//游戏背景图，根据tab切换</span>
	<span class="token operator">&lt;</span>image <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;bg&quot;</span> v<span class="token operator">-</span>show<span class="token operator">=</span><span class="token string">&quot;tabIndex === 0&quot;</span> src<span class="token operator">=</span><span class="token string">&quot;/static/images/game/RotaryTable/bg1.png&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>image <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;bg&quot;</span> v<span class="token operator">-</span>show<span class="token operator">=</span><span class="token string">&quot;tabIndex === 1&quot;</span> src<span class="token operator">=</span><span class="token string">&quot;/static/images/game/RotaryTable/bg.png&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token comment">//游戏模式tab</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;tab-box&quot;</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>image <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;item&quot;</span> <span class="token punctuation">:</span>src<span class="token operator">=</span><span class="token string">&quot;`/static/images/game/RotaryTable/tab/1${tabIndex === 0 ? '_s' : ''}.png`&quot;</span>      @tap<span class="token operator">=</span><span class="token string">&quot;handleTab(0)&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>image <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;item&quot;</span> <span class="token punctuation">:</span>src<span class="token operator">=</span><span class="token string">&quot;`/static/images/game/RotaryTable/tab/2${tabIndex === 1 ? '_s' : ''}.png`&quot;</span> @tap<span class="token operator">=</span><span class="token string">&quot;handleTab(1)&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token comment">//样式</span>
<span class="token operator">&lt;</span>style lang<span class="token operator">=</span><span class="token string">&quot;scss&quot;</span> scoped<span class="token operator">&gt;</span>
  <span class="token punctuation">.</span>container<span class="token punctuation">{</span>
    width<span class="token punctuation">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span>
    height<span class="token punctuation">:</span> <span class="token number">1022</span>rpx<span class="token punctuation">;</span>
    position<span class="token punctuation">:</span> fixed<span class="token punctuation">;</span>
    bottom<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">.</span>topWarp<span class="token punctuation">{</span>
      width<span class="token punctuation">:</span> <span class="token number">750</span>rpx<span class="token punctuation">;</span>
      height<span class="token punctuation">:</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token number">100</span>vh <span class="token operator">-</span> <span class="token number">1022</span>rpx<span class="token punctuation">)</span><span class="token punctuation">;</span>
      position<span class="token punctuation">:</span> fixed<span class="token punctuation">;</span>
      top<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token comment">//背景图及tab样式略</span>
  <span class="token punctuation">}</span>
</code></pre></div><p><strong>2、效果</strong></p> <img src="/assets/img/1-1.b8ce037f.jpg" style="zoom: 20%"> <img src="/assets/img/1-2.d4df21e5.jpg" style="zoom: 20%"> <p><strong>除转盘组件写的复杂，排行榜，记录和游戏下方的转动次数及钱币样式简单，不在展开</strong></p> <h2 id="样式部分"><a href="#样式部分" aria-hidden="true" class="header-anchor">#</a> 样式部分</h2> <p><strong>转盘内容，排行榜，记录，切换转动次数，余额</strong></p> <p><strong>样式多采用定位，浮动和动画来实现</strong></p> <p><strong>其中最复杂的地方为转盘，转盘可分为三部分，圆盘，开始游戏按钮和指针</strong></p> <h2 id="难点1：转盘中间礼物的展示"><a href="#难点1：转盘中间礼物的展示" aria-hidden="true" class="header-anchor">#</a> 难点1：转盘中间礼物的展示</h2> <p><strong>9份礼物，要展示图标及名称，让其根据礼物数据长度旋转</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//遍历礼物数据，其中每份样式</span>
<span class="token punctuation">:</span>style<span class="token operator">=</span><span class="token string">&quot;{transform:`rotate(${(360 / gameData.length) * index}deg)`}&quot;</span>

</code></pre></div><h2 id="难点2：转盘旋转特效"><a href="#难点2：转盘旋转特效" aria-hidden="true" class="header-anchor">#</a> 难点2：转盘旋转特效</h2> <p><strong>点击开始按钮，转盘旋转特效，按钮缩放效果</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 按钮 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>image <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;start_button&quot;</span> 
	<span class="token punctuation">:</span><span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;{action: start_game, start_button1: current === 1}&quot;</span>
	<span class="token punctuation">:</span>src<span class="token operator">=</span><span class="token string">&quot;`/static/images/game/RotaryTable/start${ current === 0 ? '1' : '' }.png`&quot;</span> @tap<span class="token operator">=</span><span class="token string">&quot;startGame&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token comment">//逻辑部分</span>
<span class="token comment">/** 开始 */</span>
<span class="token function">startGame</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// 按钮效果（缩放动效）</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>start_game <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
	<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>start_game <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">rotate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>

<span class="token comment">/** 旋转动画 */</span>
<span class="token function">rotate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">let</span> animation <span class="token operator">=</span> uni<span class="token punctuation">.</span><span class="token function">createAnimation</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		duration<span class="token punctuation">:</span> <span class="token number">5500</span><span class="token punctuation">,</span>
		timingFunction<span class="token punctuation">:</span> <span class="token string">&quot;ease&quot;</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	animation<span class="token punctuation">.</span><span class="token function">rotate</span><span class="token punctuation">(</span><span class="token number">3960</span> <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>playNum<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">step</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>animationData <span class="token operator">=</span> animation<span class="token punctuation">.</span><span class="token function">export</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">rotateEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">pointer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h2 id="难点3：转盘指针动画效果"><a href="#难点3：转盘指针动画效果" aria-hidden="true" class="header-anchor">#</a> 难点3：转盘指针动画效果</h2> <p><strong>转盘旋转从开始到结束，转盘上方的指针也要跟着加速-&gt;减速-&gt;停止</strong></p> <hr> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">/** 指针动画 */</span>
<span class="token function">pointer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>pointerNum <span class="token operator">&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>zhen<span class="token punctuation">.</span>$el<span class="token punctuation">.</span>style<span class="token punctuation">.</span>transform <span class="token operator">=</span> <span class="token string">&quot;rotate(0deg)&quot;</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>zhen<span class="token punctuation">.</span>$el<span class="token punctuation">.</span>style<span class="token punctuation">.</span>transform <span class="token operator">=</span> <span class="token string">&quot;rotate(-34deg)&quot;</span><span class="token punctuation">;</span>
		<span class="token function">setTimeout</span><span class="token punctuation">(</span>
			<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>zhen<span class="token punctuation">.</span>$el<span class="token punctuation">.</span>style<span class="token punctuation">.</span>transform <span class="token operator">=</span> <span class="token string">&quot;rotate(-16deg)&quot;</span><span class="token punctuation">;</span>
					<span class="token function">setTimeout</span><span class="token punctuation">(</span>
						<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
							<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">pointer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token punctuation">}</span><span class="token punctuation">,</span>
						<span class="token keyword">this</span><span class="token punctuation">.</span>pointerNum <span class="token operator">===</span> <span class="token number">1</span> <span class="token operator">?</span> <span class="token number">150</span> <span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pointerNum <span class="token operator">===</span> <span class="token number">2</span> <span class="token operator">?</span> <span class="token number">380</span> <span class="token punctuation">:</span> <span class="token number">30</span>
					<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span><span class="token punctuation">,</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>pointerNum <span class="token operator">===</span> <span class="token number">1</span> <span class="token operator">?</span> <span class="token number">120</span> <span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pointerNum <span class="token operator">===</span> <span class="token number">2</span> <span class="token operator">?</span> <span class="token number">300</span> <span class="token punctuation">:</span> <span class="token number">50</span>
			<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="难点4：交互部分"><a href="#难点4：交互部分" aria-hidden="true" class="header-anchor">#</a> 难点4：交互部分</h2> <p><strong>调用接口</strong></p> <p><strong>1.获取后台转盘配置的礼物数据</strong></p> <p><strong>2.获取用户信息，包括用户余额</strong></p> <p><strong>3.获取排行榜信息，获取记录信息</strong></p> <p><strong>4.点击开始，调用接口，并把中奖礼物下标传给上级组件，展示接口返回的中奖礼物信息</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//转盘组件</span>
<span class="token comment">/** 开始 */</span>
		<span class="token function">startGame</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>startPlay<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>disable<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">&quot;disableClick&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">&quot;start&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">&quot;update:start&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>game_end <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>pointerNum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

			<span class="token comment">// 按钮效果</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>start_game <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
			<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>start_game <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">rotate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>

		<span class="token comment">/** 旋转动画 */</span>
		<span class="token function">rotate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>game_end<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>playNum<span class="token operator">++</span><span class="token punctuation">;</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>startPlay <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'pointerNum'</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>pointerNum<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">let</span> animation <span class="token operator">=</span> uni<span class="token punctuation">.</span><span class="token function">createAnimation</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
				duration<span class="token punctuation">:</span> <span class="token number">2000</span><span class="token punctuation">,</span>
				timingFunction<span class="token punctuation">:</span> <span class="token string">&quot;linear&quot;</span><span class="token punctuation">,</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

			animation<span class="token punctuation">.</span><span class="token function">rotate</span><span class="token punctuation">(</span><span class="token number">3960</span> <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>playNum<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">step</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>animationData <span class="token operator">=</span> animation<span class="token punctuation">.</span><span class="token function">export</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">rotate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">pointer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token comment">/** 旋转结束 */</span>
		<span class="token function">rotateEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>playNum<span class="token operator">++</span><span class="token punctuation">;</span>
			<span class="token keyword">let</span> animation <span class="token operator">=</span> uni<span class="token punctuation">.</span><span class="token function">createAnimation</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
				duration<span class="token punctuation">:</span> <span class="token number">4000</span><span class="token punctuation">,</span>
				timingFunction<span class="token punctuation">:</span> <span class="token string">&quot;cubic-bezier(0, 0.6, 0, 1.01)&quot;</span><span class="token punctuation">,</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>pointerNum <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>pointerNum <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2800</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>pointerNum <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>current <span class="token operator">===</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">3000</span> <span class="token punctuation">:</span> <span class="token number">3200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">&quot;end&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token comment">/** 复原状态 */</span>
				<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>startPlay <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">&quot;update:start&quot;</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">4000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token comment">// 中奖礼物最中间位置</span>
			<span class="token keyword">const</span> center <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>zp_list<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token keyword">this</span><span class="token punctuation">.</span>number<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">360</span> <span class="token operator">/</span> <span class="token keyword">this</span><span class="token punctuation">.</span>zp_list<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment">// 边缘</span>
			<span class="token keyword">const</span> edge <span class="token operator">=</span> <span class="token number">360</span> <span class="token operator">/</span> <span class="token keyword">this</span><span class="token punctuation">.</span>zp_list<span class="token punctuation">.</span>length <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">-</span> <span class="token number">4</span><span class="token punctuation">;</span>
			<span class="token comment">// 随机位置</span>
			<span class="token keyword">const</span> radom <span class="token operator">=</span> <span class="token function">getRadom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>radom<span class="token punctuation">)</span><span class="token punctuation">;</span>
			animation<span class="token punctuation">.</span><span class="token function">rotate</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>playNum <span class="token operator">*</span> <span class="token number">3960</span> <span class="token operator">+</span> center <span class="token operator">+</span> radom<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">step</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>animationData <span class="token operator">=</span> animation<span class="token punctuation">.</span><span class="token function">export</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token keyword">function</span> <span class="token function">getRadom</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token comment">// 随机位置</span>
				<span class="token keyword">const</span> p <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>edge <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> edge<span class="token punctuation">;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token comment">// 不能在中间</span>
					<span class="token keyword">const</span> position <span class="token operator">=</span> <span class="token punctuation">[</span>edge <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">,</span> edge <span class="token operator">-</span> <span class="token number">6</span><span class="token punctuation">,</span> edge <span class="token operator">-</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token punctuation">(</span>edge <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token punctuation">(</span>edge <span class="token operator">-</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token punctuation">(</span>edge <span class="token operator">-</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
					<span class="token keyword">return</span> position<span class="token punctuation">[</span>Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				<span class="token keyword">return</span> p
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>

		<span class="token comment">/** 指针动画 */</span>
		<span class="token function">pointer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>pointerNum <span class="token operator">&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>zhen<span class="token punctuation">.</span>$el<span class="token punctuation">.</span>style<span class="token punctuation">.</span>transform <span class="token operator">=</span> <span class="token string">&quot;rotate(0deg)&quot;</span><span class="token punctuation">;</span>
				<span class="token keyword">return</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>zhen<span class="token punctuation">.</span>$el<span class="token punctuation">.</span>style<span class="token punctuation">.</span>transform <span class="token operator">=</span> <span class="token string">&quot;rotate(-34deg)&quot;</span><span class="token punctuation">;</span>
			<span class="token function">setTimeout</span><span class="token punctuation">(</span>
				<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>zhen<span class="token punctuation">.</span>$el<span class="token punctuation">.</span>style<span class="token punctuation">.</span>transform <span class="token operator">=</span> <span class="token string">&quot;rotate(-16deg)&quot;</span><span class="token punctuation">;</span>
					<span class="token function">setTimeout</span><span class="token punctuation">(</span>
						<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
							<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">pointer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token punctuation">}</span><span class="token punctuation">,</span>
						<span class="token keyword">this</span><span class="token punctuation">.</span>pointerNum <span class="token operator">===</span> <span class="token number">1</span> <span class="token operator">?</span> <span class="token number">150</span> <span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pointerNum <span class="token operator">===</span> <span class="token number">2</span> <span class="token operator">?</span> <span class="token number">380</span> <span class="token punctuation">:</span> <span class="token number">30</span>
					<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span><span class="token punctuation">,</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>pointerNum <span class="token operator">===</span> <span class="token number">1</span> <span class="token operator">?</span> <span class="token number">120</span> <span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pointerNum <span class="token operator">===</span> <span class="token number">2</span> <span class="token operator">?</span> <span class="token number">300</span> <span class="token punctuation">:</span> <span class="token number">50</span>
			<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
    
<span class="token comment">/** 父组件，开始游戏 */</span>
		<span class="token function">startPlayGame</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>number <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>giftDataLists <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token keyword">const</span> params <span class="token operator">=</span> <span class="token punctuation">{</span>
				room_id<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>room_id<span class="token punctuation">,</span>
				session_id<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>session_id<span class="token punctuation">,</span>
				game_id<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>game_list<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>tabIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>id<span class="token punctuation">,</span>
				num<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>start_number<span class="token punctuation">,</span>
				token<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>token<span class="token punctuation">,</span>
			<span class="token punctuation">}</span><span class="token punctuation">;</span>
			<span class="token function">playGame</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>
				<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
					<span class="token comment">// 礼物列表</span>
					<span class="token keyword">const</span> prize <span class="token operator">=</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>prize<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>data<span class="token punctuation">;</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>giftDataLists <span class="token operator">=</span> prize<span class="token punctuation">;</span>
					<span class="token comment">// 获取到中奖下标</span>
					<span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>zp_list<span class="token punctuation">.</span><span class="token function">findIndex</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> prize<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>id <span class="token operator">==</span> item<span class="token punctuation">.</span>prize_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
						i <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>zp_list<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>number <span class="token operator">=</span> i<span class="token punctuation">;</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getGameProp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span>
				<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>number <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>noGlft <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$showToast</span><span class="token punctuation">(</span><span class="token string">&quot;当前人数较多，请稍后尝试&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment">// 如果接口出现问题不让继续旋转了</span>
			<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>giftDataLists<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>number <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>noGlft <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$showToast</span><span class="token punctuation">(</span><span class="token string">&quot;当前人数较多，请稍后尝试&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">4000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token comment">/** 游戏结束 */</span>
		<span class="token function">endGame</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>number <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>noGlft<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>getGift<span class="token punctuation">.</span>popupShow <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>noGlft<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>noGlft <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/app.76969911.js" defer></script><script src="/assets/js/2.948fdc9a.js" defer></script>
  </body>
</html>
